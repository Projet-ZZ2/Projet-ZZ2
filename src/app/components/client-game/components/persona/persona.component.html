<div class="persona-container">
  <div class="persona-explanation">
    <h3>üë§ Cr√©ation du Persona</h3>
    <p>
      Cr√©ez un persona repr√©sentatif de vos utilisateurs en vous basant sur les informations
      collect√©es lors des entretiens. Plus votre persona correspond aux besoins identifi√©s, plus
      vous gagnez de points !
    </p>
  </div>

  <!-- Informations collect√©es -->
  <div class="collected-infos-summary">
    <h4>üìã Rappel des informations collect√©es :</h4>
    <div class="infos-overview">
      @for (info of gameService.getCollectedInfos(); track info.id) {
        <div class="info-pill" [class]="info.type">
          {{ info.content }}
        </div>
      }
    </div>
  </div>

  <!-- Formulaire de cr√©ation du persona -->
  <div class="persona-form">
    <div class="persona-preview">
      <div class="persona-avatar">
        <div class="avatar-placeholder">
          {{ getPersonaInitials() }}
        </div>
      </div>
      <h4>{{ personaName() || 'Nom du persona' }}</h4>
    </div>

    <div class="form-section">
      <label for="persona-name">Nom du persona :</label>
      <input
        id="persona-name"
        type="text"
        [value]="personaName()"
        (input)="updatePersonaName($event)"
        placeholder="Ex: Marie Dupont"
        class="persona-input"
      />
    </div>

    <div class="characteristics-grid">
      <!-- √Çge -->
      <div class="characteristic-section">
        <h5>üéÇ √Çge</h5>
        <div class="options-grid">
          @for (option of ageOptions; track option.value) {
            <button
              class="option-button"
              [class.selected]="getSelectedCharacteristic('age') === option.value"
              (click)="selectCharacteristic('age', option.value, option.label)"
            >
              {{ option.label }}
            </button>
          }
        </div>
      </div>

      <!-- Profession -->
      <div class="characteristic-section">
        <h5>üíº Profession</h5>
        <div class="options-grid">
          @for (option of professionOptions; track option.value) {
            <button
              class="option-button"
              [class.selected]="getSelectedCharacteristic('profession') === option.value"
              (click)="selectCharacteristic('profession', option.value, option.label)"
            >
              {{ option.label }}
            </button>
          }
        </div>
      </div>

      <!-- Besoins -->
      <div class="characteristic-section">
        <h5>‚≠ê Besoins principaux</h5>
        <div class="options-grid">
          @for (option of needsOptions; track option.value) {
            <button
              class="option-button"
              [class.selected]="getSelectedCharacteristic('needs') === option.value"
              (click)="selectCharacteristic('needs', option.value, option.label)"
            >
              {{ option.label }}
            </button>
          }
        </div>
      </div>

      <!-- Frustrations -->
      <div class="characteristic-section">
        <h5>üò§ Frustrations</h5>
        <div class="options-grid">
          @for (option of frustrationOptions; track option.value) {
            <button
              class="option-button"
              [class.selected]="getSelectedCharacteristic('frustrations') === option.value"
              (click)="selectCharacteristic('frustrations', option.value, option.label)"
            >
              {{ option.label }}
            </button>
          }
        </div>
      </div>

      <!-- Objectifs -->
      <div class="characteristic-section">
        <h5>üéØ Objectifs</h5>
        <div class="options-grid">
          @for (option of goalsOptions; track option.value) {
            <button
              class="option-button"
              [class.selected]="getSelectedCharacteristic('goals') === option.value"
              (click)="selectCharacteristic('goals', option.value, option.label)"
            >
              {{ option.label }}
            </button>
          }
        </div>
      </div>
    </div>

    <!-- Validation -->
    <div class="validation-section">
      <button
        class="validate-persona-button"
        [disabled]="!canValidatePersona()"
        (click)="validatePersona()"
      >
        @if (isPersonaSubmitted()) {
          ‚úÖ Persona valid√© ({{ lastScore() }} pts)
        } @else {
          Valider le persona
        }
      </button>

      @if (canValidatePersona() && !isPersonaSubmitted()) {
        <p class="validation-hint">
          Toutes les caract√©ristiques sont s√©lectionn√©es ! Cliquez pour valider et voir votre score.
        </p>
      } @else if (!canValidatePersona()) {
        <p class="validation-hint">S√©lectionnez une option pour chaque caract√©ristique.</p>
      }
    </div>

    <!-- R√©sultats apr√®s validation -->
    @if (isPersonaSubmitted()) {
      <div class="persona-results">
        <h4>üìä √âvaluation de votre persona :</h4>
        <div class="results-grid">
          @for (char of personaCharacteristics(); track char.type) {
            <div class="result-item" [class.correct]="char.isCorrect">
              <span class="result-icon">{{ char.isCorrect ? '‚úÖ' : '‚ùå' }}</span>
              <span class="result-text">{{ getCharacteristicLabel(char.type) }}</span>
              <span class="result-value">{{ char.value }}</span>
            </div>
          }
        </div>
      </div>
    }
  </div>

  <!-- Conseils -->
  <div class="tips-section">
    <h4>üí° Conseils</h4>
    <ul>
      <li>Basez-vous sur les informations collect√©es lors des entretiens</li>
      <li>Pensez aux th√®mes identifi√©s (enfants, √©pur√©, geek, √¢g√©)</li>
      <li>Les besoins et frustrations doivent correspondre aux infos UX collect√©es</li>
      <li>Un persona coh√©rent rapporte plus de points</li>
    </ul>
  </div>
</div>
